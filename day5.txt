master做了修改




day4 回顾

1. 索引 
  1） 什么是索引：提高数据库查询的一种技术
  2） 通过对数据排序、分段、避免全表扫描、提高查询效率
  3） 创建索引
      create table 表名(
          ......
          unique(字段),index(字段)
      )； 
      create 索引类型 索引名称
        on 表名（字段名）;
  4) 索引的优缺点：
    - 优点：提高查询效率，唯一索引可以保证数据的唯一性
    - 缺点：增加存储空间，会降低增删改的效率
  5） 索引使用要点
    - 原则：不宜过多，在合适的字段使用合适的索引
    - 适合使用索引的情况
      经常进行查询、分组、排序的字段
      数据分布相对均匀、连续的字段
      查询操作较多的表
    - 不适合使用索引的情况
      表的数据量较少  
      增删改操作较多的表
      字段取值较少的情况
      二进制字段不适合建立索引

2. 数据库事务
1） 作用：保证一组操作要么全都执行、要么全都不执行
2） 特性:ACID
  - 原子性： 一组操作要么全执行，要么不执行
  - 一致性： 事务完成后，由上一个一致状态
    变成下一个一致状态
  - 隔离性： 事务之间不相互影响
  - 持久性： 事务一旦提交，对数据库的修改会永久保存

3） 前提：InnoDB存储引擎
4） 事务操作
  - 开启：
    显式： start transaction
    隐式： 执行增删改语句
  - 提交： commit
  - 回滚： rollback

3. 权限管理
1） 什么是权限：用户可以执行的操作
2） 授权
    grant 权限列表 on 库名.表名
    to '用户'@‘客户端'
    [identified by '密码']
    [with grant option]
3） 吊销
    revoke 权限列表 on 库名.表名
    from '用户'@‘客户端' 
4） 查看
  - 查看自己权限：show grants
  - 查看别人权限：
    show grants from '用户'@'客户端'





day5 笔记

一、锁
1）概念：锁是对数据的控制权
2）目的：解决多个工作单元并发操作数据所导致的问题
3）分类：
  - 锁类型
    读锁（共享锁）：select操作时加锁，加锁之后其它工作单元可以
    读、不能写的数据
    写锁（排它锁）：insert/delete/update
        操作时加锁，加锁之后不能读、写
  
  - 锁粒度
    行级锁：锁定一行，并发效率高，资源消耗较多
    表级锁：锁定整张表，并发效率低，资源消耗少


二、存储引擎
1. 什么时存储引擎：表的存储方式，包括存储机制、索引机制，锁定方式
2. 基本操作
1） 查看： show engines;
2） 查看表的存储引擎：通过建表语句查看
    show create table 表名
3） 修改：
    alter table t1 engine=MyISAM;

3. 常用存储引擎
1） InnoDB
  - 特点：支持事务、行级锁、外键，共享表空间
  - 文件构成：
    表名.frm: 表结构和索引
    表名.ibd: 表记录 
  * show global variables
    like '%datadir%'查看数据存储目录
    需要sudo -i 切换root才能查看
  - 适用情景
    更新密集的表
    有事务要求
    有外键约束要求
    需要支持自增长字段
2） MyISAM
  - 特点：不支持事务、行级锁，外键访问速度较快，独占表空间 
  
  - 文件：
    表名.frm: 表结构
    表名.myd: 表记录
    表名.myi: 索引

  - 示例：
    create table tt(
     name varchar(32)
    ) engine=MyISAM;
    切换到root用户下：
    sudo -i
    查看存储目录：show global variables
    like '%datadir%'
    进入目录：
    cd /var/lib/mysql/eshop
    ls tt*
    可以查看到文件：
    tt.frm   tt.myd    tt.myi
    




  - 适用情景：
    查询请求较多的表
    数据一致性要求较低
    不需要外键约束

    
3） Memory
  - 特点： 访问速度快；表结构存于磁盘
    数据存于内存：数据库重启后，数据丢失

  - 文件构成：
    表名.frm

  - 适用情景：
    数据量小，速度要求高，数据丢失影响小

三、E-R概念模型
1） 什么是E-R概念模型：实体-关系模型，
    用一种抽象化的方式来表达数据、数据之间的联系

2） 优点：能够很好的将数据、数据间的联系直观的表达出来

3） 实体间的对应关系
   一对一：老公 <--> 老婆
   一对多：父亲 <--> 孩子
          客户 <--> 订单
          账户 <--> 交易明细 
   多对多： 兄弟姊妹 <--> 兄弟姊妹
           学生 <--> 课程
4） E-R图：用图形化方式表达实体-关系
    
四、Python访问数据库：pymsql
1. 安装
1） 在线： sudo pip3 install 四、Python访问数据库：pymsql
1） 离线： 
    第一步：下载安装包
      https://pypi.org/project/pymsql/#files
      例如下载包名称为：pymsql-0.9.3.tar.gz
    第二步： 解压
      tar-zxvf pymsql-0.9.3.tar.gz
    第三步：进入解压后的目录，执行安装
      cd pymsql-0.9.3
      python3 setup.py install
    第四步：验证，进入python的交互模式，执行
      import mymsql命令，如果不报错，说明安装成功


    开启Mysql 服务：
    sudo /etc/init.d/mysql start



2.pymsql访问数据库的步骤
1） 导入pymsql模块
2） 创建数据库连接
3） 创建游标对象
4） 使用游标对象提供的方法，执行SQL语句
5） 提交事务（如果需要）
5） 关闭游标
6） 关闭数据库连接对象








